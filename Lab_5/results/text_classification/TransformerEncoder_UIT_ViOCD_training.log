2025-12-31 22:27:23,107 - INFO - ==================================================
2025-12-31 22:27:23,107 - INFO - STARTING PROCESS FOR EXPERIMENT: TransformerEncoder_UIT_ViOCD
2025-12-31 22:27:23,107 - INFO - Log file location: ./results/text_classification\TransformerEncoder_UIT_ViOCD_training.log
2025-12-31 22:27:23,107 - INFO - Loading configuration from: E:\DS201.Q11\DS201\Lab_5\config\Transformer_Encoder_UIT_ViOCD.yml
2025-12-31 22:27:23,110 - INFO - 
Running Experiment: TransformerEncoder_UIT_ViOCD
2025-12-31 22:27:23,110 - INFO - Model: TransformerEncoder, Dataset: uit_viocd
2025-12-31 22:27:23,110 - INFO - Hyperparameters: {'epochs': 50, 'early_stop_patience': 10, 'lr': 0.0002, 'weight_decay': 1e-05, 'batch_size': 32, 'optimizer': 'Adam', 'step_size': 30, 'gamma': 0.1, 'optimizer_params': {}}
2025-12-31 22:27:23,119 - INFO - Using device: cuda
2025-12-31 22:27:23,225 - INFO - Loading dataset: uit_viocd
2025-12-31 22:27:23,240 - INFO - Train: 4387, Val: 548, Test: 549
2025-12-31 22:27:23,241 - INFO - Sample sentence size: torch.Size([20]), Number of classes: 4
2025-12-31 22:27:23,328 - INFO - 
[INFO] Class Distribution (Train Data):
+----------+---------+
| Label    |   Count |
+==========+=========+
| app      |    1613 |
+----------+---------+
| fashion  |    1368 |
+----------+---------+
| cosmetic |    1043 |
+----------+---------+
| mobile   |     363 |
+----------+---------+
2025-12-31 22:27:23,328 - INFO - Using optimizer: Adam with LR=0.0002, WeightDecay=1e-05
2025-12-31 22:27:24,350 - INFO - START TRAINING TransformerEncoder_UIT_ViOCD...
2025-12-31 22:27:24,350 - INFO - No checkpoint found at checkpoints/TransformerEncoder_UIT_ViOCD/TransformerEncoder_UIT_ViOCD_last_checkpoint.pth
2025-12-31 22:27:28,114 - INFO - 
|   Epoch |   Train Loss |   Train Acc |   Train Precision |   Train Recall |   Train F1 |   Val Loss |   Val Acc |   Val Precision |   Val Recall |   Val F1 |
|---------|--------------|-------------|-------------------|----------------|------------|------------|-----------|-----------------|--------------|----------|
|       0 |       1.0387 |      0.6201 |            0.4702 |         0.4906 |     0.4635 |     0.8167 |    0.7591 |            0.75 |       0.6408 |   0.6322 |
2025-12-31 22:27:28,114 - INFO - 
[INFO]: Saving best model at epoch 0 to: checkpoints/TransformerEncoder_UIT_ViOCD/TransformerEncoder_UIT_ViOCD_best_model.pth
2025-12-31 22:27:31,548 - INFO - 
|   Epoch |   Train Loss |   Train Acc |   Train Precision |   Train Recall |   Train F1 |   Val Loss |   Val Acc |   Val Precision |   Val Recall |   Val F1 |
|---------|--------------|-------------|-------------------|----------------|------------|------------|-----------|-----------------|--------------|----------|
|       1 |       0.8412 |      0.7482 |            0.6256 |         0.6368 |     0.6123 |     0.7536 |    0.7993 |          0.8178 |       0.6877 |   0.6861 |
2025-12-31 22:27:31,549 - INFO - 
[INFO]: Saving best model at epoch 1 to: checkpoints/TransformerEncoder_UIT_ViOCD/TransformerEncoder_UIT_ViOCD_best_model.pth
2025-12-31 22:27:35,063 - INFO - 
|   Epoch |   Train Loss |   Train Acc |   Train Precision |   Train Recall |   Train F1 |   Val Loss |   Val Acc |   Val Precision |   Val Recall |   Val F1 |
|---------|--------------|-------------|-------------------|----------------|------------|------------|-----------|-----------------|--------------|----------|
|       2 |       0.7716 |      0.7854 |            0.7072 |         0.6924 |     0.6782 |     0.7717 |     0.792 |          0.8053 |       0.7279 |   0.7408 |
2025-12-31 22:27:35,063 - INFO - 
[INFO]: Saving best model at epoch 2 to: checkpoints/TransformerEncoder_UIT_ViOCD/TransformerEncoder_UIT_ViOCD_best_model.pth
2025-12-31 22:27:44,807 - INFO - ==================================================
2025-12-31 22:27:44,807 - INFO - STARTING PROCESS FOR EXPERIMENT: TransformerEncoder_UIT_ViOCD
2025-12-31 22:27:44,807 - INFO - Log file location: ./results/text_classification\TransformerEncoder_UIT_ViOCD_training.log
2025-12-31 22:27:44,808 - INFO - Loading configuration from: E:\DS201.Q11\DS201\Lab_5\config\Transformer_Encoder_UIT_ViOCD.yml
2025-12-31 22:27:44,808 - INFO - 
Running Experiment: TransformerEncoder_UIT_ViOCD
2025-12-31 22:27:44,808 - INFO - Model: TransformerEncoder, Dataset: uit_viocd
2025-12-31 22:27:44,808 - INFO - Hyperparameters: {'epochs': 50, 'early_stop_patience': 10, 'lr': 0.001, 'weight_decay': 1e-05, 'batch_size': 32, 'optimizer': 'Adam', 'step_size': 30, 'gamma': 0.1, 'optimizer_params': {}}
2025-12-31 22:27:44,822 - INFO - Using device: cuda
2025-12-31 22:27:44,930 - INFO - Loading dataset: uit_viocd
2025-12-31 22:27:44,943 - INFO - Train: 4387, Val: 548, Test: 549
2025-12-31 22:27:44,944 - INFO - Sample sentence size: torch.Size([20]), Number of classes: 4
2025-12-31 22:27:45,030 - INFO - 
[INFO] Class Distribution (Train Data):
+----------+---------+
| Label    |   Count |
+==========+=========+
| app      |    1613 |
+----------+---------+
| fashion  |    1368 |
+----------+---------+
| cosmetic |    1043 |
+----------+---------+
| mobile   |     363 |
+----------+---------+
2025-12-31 22:27:45,031 - INFO - Using optimizer: Adam with LR=0.001, WeightDecay=1e-05
2025-12-31 22:27:46,074 - INFO - START TRAINING TransformerEncoder_UIT_ViOCD...
2025-12-31 22:27:46,074 - INFO - No checkpoint found at checkpoints/TransformerEncoder_UIT_ViOCD/TransformerEncoder_UIT_ViOCD_last_checkpoint.pth
2025-12-31 22:27:49,875 - INFO - 
|   Epoch |   Train Loss |   Train Acc |   Train Precision |   Train Recall |   Train F1 |   Val Loss |   Val Acc |   Val Precision |   Val Recall |   Val F1 |
|---------|--------------|-------------|-------------------|----------------|------------|------------|-----------|-----------------|--------------|----------|
|       0 |       0.9589 |      0.6814 |            0.5599 |         0.5666 |     0.5385 |     0.7719 |     0.781 |          0.7634 |       0.7115 |   0.7218 |
2025-12-31 22:27:49,875 - INFO - 
[INFO]: Saving best model at epoch 0 to: checkpoints/TransformerEncoder_UIT_ViOCD/TransformerEncoder_UIT_ViOCD_best_model.pth
2025-12-31 22:27:53,388 - INFO - 
|   Epoch |   Train Loss |   Train Acc |   Train Precision |   Train Recall |   Train F1 |   Val Loss |   Val Acc |   Val Precision |   Val Recall |   Val F1 |
|---------|--------------|-------------|-------------------|----------------|------------|------------|-----------|-----------------|--------------|----------|
|       1 |       0.7863 |      0.7792 |            0.6976 |         0.6866 |     0.6687 |     0.8162 |    0.7847 |           0.834 |       0.6725 |   0.6728 |
2025-12-31 22:27:56,912 - INFO - 
|   Epoch |   Train Loss |   Train Acc |   Train Precision |   Train Recall |   Train F1 |   Val Loss |   Val Acc |   Val Precision |   Val Recall |   Val F1 |
|---------|--------------|-------------|-------------------|----------------|------------|------------|-----------|-----------------|--------------|----------|
|       2 |       0.7423 |      0.8057 |            0.7563 |         0.7272 |     0.7189 |     0.7288 |    0.8066 |          0.8034 |       0.7494 |   0.7616 |
2025-12-31 22:27:56,913 - INFO - 
[INFO]: Saving best model at epoch 2 to: checkpoints/TransformerEncoder_UIT_ViOCD/TransformerEncoder_UIT_ViOCD_best_model.pth
2025-12-31 22:28:00,449 - INFO - 
|   Epoch |   Train Loss |   Train Acc |   Train Precision |   Train Recall |   Train F1 |   Val Loss |   Val Acc |   Val Precision |   Val Recall |   Val F1 |
|---------|--------------|-------------|-------------------|----------------|------------|------------|-----------|-----------------|--------------|----------|
|       3 |       0.7152 |      0.8173 |            0.7595 |         0.7297 |     0.7228 |     0.7343 |    0.8102 |          0.8068 |       0.7499 |   0.7607 |
2025-12-31 22:28:04,007 - INFO - 
|   Epoch |   Train Loss |   Train Acc |   Train Precision |   Train Recall |   Train F1 |   Val Loss |   Val Acc |   Val Precision |   Val Recall |   Val F1 |
|---------|--------------|-------------|-------------------|----------------|------------|------------|-----------|-----------------|--------------|----------|
|       4 |       0.7277 |      0.8112 |            0.7591 |         0.7322 |     0.7199 |     0.7104 |    0.8139 |            0.85 |       0.7137 |   0.7245 |
2025-12-31 22:28:07,516 - INFO - 
|   Epoch |   Train Loss |   Train Acc |   Train Precision |   Train Recall |   Train F1 |   Val Loss |   Val Acc |   Val Precision |   Val Recall |   Val F1 |
|---------|--------------|-------------|-------------------|----------------|------------|------------|-----------|-----------------|--------------|----------|
|       5 |       0.7128 |      0.8154 |            0.7601 |         0.7371 |     0.7283 |     0.7149 |    0.8066 |          0.8062 |       0.7496 |   0.7608 |
2025-12-31 22:28:11,080 - INFO - 
|   Epoch |   Train Loss |   Train Acc |   Train Precision |   Train Recall |   Train F1 |   Val Loss |   Val Acc |   Val Precision |   Val Recall |   Val F1 |
|---------|--------------|-------------|-------------------|----------------|------------|------------|-----------|-----------------|--------------|----------|
|       6 |       0.7104 |      0.8152 |            0.7599 |         0.7386 |     0.7283 |     0.6887 |    0.8175 |           0.821 |       0.7459 |   0.7598 |
2025-12-31 22:28:14,631 - INFO - 
|   Epoch |   Train Loss |   Train Acc |   Train Precision |   Train Recall |   Train F1 |   Val Loss |   Val Acc |   Val Precision |   Val Recall |   Val F1 |
|---------|--------------|-------------|-------------------|----------------|------------|------------|-----------|-----------------|--------------|----------|
|       7 |       0.7132 |      0.8182 |            0.7632 |         0.7387 |     0.7287 |     0.6562 |    0.8431 |          0.8394 |       0.7726 |   0.7883 |
2025-12-31 22:28:14,632 - INFO - 
[INFO]: Saving best model at epoch 7 to: checkpoints/TransformerEncoder_UIT_ViOCD/TransformerEncoder_UIT_ViOCD_best_model.pth
2025-12-31 22:28:18,227 - INFO - 
|   Epoch |   Train Loss |   Train Acc |   Train Precision |   Train Recall |   Train F1 |   Val Loss |   Val Acc |   Val Precision |   Val Recall |   Val F1 |
|---------|--------------|-------------|-------------------|----------------|------------|------------|-----------|-----------------|--------------|----------|
|       8 |       0.7076 |      0.8187 |            0.7595 |         0.7435 |     0.7326 |     0.6499 |    0.8467 |          0.8737 |       0.7653 |   0.7839 |
2025-12-31 22:28:21,766 - INFO - 
|   Epoch |   Train Loss |   Train Acc |   Train Precision |   Train Recall |   Train F1 |   Val Loss |   Val Acc |   Val Precision |   Val Recall |   Val F1 |
|---------|--------------|-------------|-------------------|----------------|------------|------------|-----------|-----------------|--------------|----------|
|       9 |       0.7233 |      0.8099 |            0.7569 |         0.7305 |     0.7208 |     0.6578 |    0.8339 |          0.8362 |       0.7585 |   0.7764 |
2025-12-31 22:28:25,313 - INFO - 
|   Epoch |   Train Loss |   Train Acc |   Train Precision |   Train Recall |   Train F1 |   Val Loss |   Val Acc |   Val Precision |   Val Recall |   Val F1 |
|---------|--------------|-------------|-------------------|----------------|------------|------------|-----------|-----------------|--------------|----------|
|      10 |       0.7324 |      0.8005 |            0.7386 |         0.7158 |     0.7034 |     0.6819 |    0.8412 |          0.8397 |       0.7692 |   0.7835 |
2025-12-31 22:28:28,833 - INFO - 
|   Epoch |   Train Loss |   Train Acc |   Train Precision |   Train Recall |   Train F1 |   Val Loss |   Val Acc |   Val Precision |   Val Recall |   Val F1 |
|---------|--------------|-------------|-------------------|----------------|------------|------------|-----------|-----------------|--------------|----------|
|      11 |       0.7145 |      0.8139 |            0.7514 |         0.7314 |     0.7204 |     0.7002 |    0.8303 |          0.8346 |       0.7611 |   0.7762 |
2025-12-31 22:28:32,579 - INFO - 
|   Epoch |   Train Loss |   Train Acc |   Train Precision |   Train Recall |   Train F1 |   Val Loss |   Val Acc |   Val Precision |   Val Recall |   Val F1 |
|---------|--------------|-------------|-------------------|----------------|------------|------------|-----------|-----------------|--------------|----------|
|      12 |       0.7246 |      0.8059 |            0.7653 |         0.7295 |     0.7231 |     0.7121 |    0.8157 |          0.8144 |       0.7629 |   0.7748 |
2025-12-31 22:28:36,456 - INFO - 
|   Epoch |   Train Loss |   Train Acc |   Train Precision |   Train Recall |   Train F1 |   Val Loss |   Val Acc |   Val Precision |   Val Recall |   Val F1 |
|---------|--------------|-------------|-------------------|----------------|------------|------------|-----------|-----------------|--------------|----------|
|      13 |       0.7263 |      0.8121 |            0.7489 |         0.7225 |     0.7157 |     0.7026 |    0.8266 |          0.8132 |        0.744 |   0.7555 |
2025-12-31 22:28:40,279 - INFO - 
|   Epoch |   Train Loss |   Train Acc |   Train Precision |   Train Recall |   Train F1 |   Val Loss |   Val Acc |   Val Precision |   Val Recall |   Val F1 |
|---------|--------------|-------------|-------------------|----------------|------------|------------|-----------|-----------------|--------------|----------|
|      14 |       0.7425 |       0.798 |            0.7436 |         0.7105 |     0.7053 |     0.7033 |    0.8266 |          0.8274 |       0.7493 |   0.7668 |
2025-12-31 22:36:10,964 - INFO - ==================================================
2025-12-31 22:36:10,964 - INFO - STARTING PROCESS FOR EXPERIMENT: TransformerEncoder_UIT_ViOCD
2025-12-31 22:36:10,964 - INFO - Log file location: ./results/text_classification\TransformerEncoder_UIT_ViOCD_training.log
2025-12-31 22:36:10,964 - INFO - Loading configuration from: E:\DS201.Q11\DS201\Lab_5\config\Transformer_Encoder_UIT_ViOCD.yml
2025-12-31 22:36:10,965 - INFO - 
Running Experiment: TransformerEncoder_UIT_ViOCD
2025-12-31 22:36:10,965 - INFO - Model: TransformerEncoder, Dataset: uit_viocd
2025-12-31 22:36:10,965 - INFO - Hyperparameters: {'epochs': 50, 'early_stop_patience': 10, 'lr': 0.0003, 'weight_decay': 1e-05, 'batch_size': 32, 'optimizer': 'Adam', 'step_size': 30, 'gamma': 0.1, 'optimizer_params': {}}
2025-12-31 22:36:10,981 - INFO - Using device: cuda
2025-12-31 22:36:11,151 - INFO - Loading dataset: uit_viocd
2025-12-31 22:36:11,175 - INFO - Train: 4387, Val: 548, Test: 549
2025-12-31 22:36:11,176 - INFO - Sample sentence size: torch.Size([20]), Number of classes: 4
2025-12-31 22:36:11,329 - INFO - 
[INFO] Class Distribution (Train Data):
+----------+---------+
| Label    |   Count |
+==========+=========+
| app      |    1613 |
+----------+---------+
| fashion  |    1368 |
+----------+---------+
| cosmetic |    1043 |
+----------+---------+
| mobile   |     363 |
+----------+---------+
2025-12-31 22:36:11,330 - INFO - Using optimizer: Adam with LR=0.0003, WeightDecay=1e-05
2025-12-31 22:36:13,030 - INFO - START TRAINING TransformerEncoder_UIT_ViOCD...
2025-12-31 22:36:13,030 - INFO - No checkpoint found at checkpoints/TransformerEncoder_UIT_ViOCD/TransformerEncoder_UIT_ViOCD_last_checkpoint.pth
2025-12-31 22:36:17,250 - INFO - 
|   Epoch |   Train Loss |   Train Acc |   Train Precision |   Train Recall |   Train F1 |   Val Loss |   Val Acc |   Val Precision |   Val Recall |   Val F1 |
|---------|--------------|-------------|-------------------|----------------|------------|------------|-----------|-----------------|--------------|----------|
|       0 |       0.9376 |      0.6583 |            0.5022 |         0.5308 |     0.5008 |     0.6834 |    0.7865 |          0.8132 |       0.6867 |   0.6933 |
2025-12-31 22:36:17,250 - INFO - 
[INFO]: Saving best model at epoch 0 to: checkpoints/TransformerEncoder_UIT_ViOCD/TransformerEncoder_UIT_ViOCD_best_model.pth
2025-12-31 22:36:21,010 - INFO - 
|   Epoch |   Train Loss |   Train Acc |   Train Precision |   Train Recall |   Train F1 |   Val Loss |   Val Acc |   Val Precision |   Val Recall |   Val F1 |
|---------|--------------|-------------|-------------------|----------------|------------|------------|-----------|-----------------|--------------|----------|
|       1 |        0.714 |      0.7726 |            0.6856 |         0.6799 |     0.6607 |     0.6891 |    0.7974 |          0.8296 |       0.7059 |   0.7104 |
2025-12-31 22:36:21,010 - INFO - 
[INFO]: Saving best model at epoch 1 to: checkpoints/TransformerEncoder_UIT_ViOCD/TransformerEncoder_UIT_ViOCD_best_model.pth
2025-12-31 22:36:24,874 - INFO - 
|   Epoch |   Train Loss |   Train Acc |   Train Precision |   Train Recall |   Train F1 |   Val Loss |   Val Acc |   Val Precision |   Val Recall |   Val F1 |
|---------|--------------|-------------|-------------------|----------------|------------|------------|-----------|-----------------|--------------|----------|
|       2 |       0.6379 |      0.8089 |            0.7439 |         0.7208 |     0.7111 |     0.6636 |    0.8212 |          0.8306 |       0.7707 |   0.7829 |
2025-12-31 22:36:24,879 - INFO - 
[INFO]: Saving best model at epoch 2 to: checkpoints/TransformerEncoder_UIT_ViOCD/TransformerEncoder_UIT_ViOCD_best_model.pth
2025-12-31 22:36:28,710 - INFO - 
|   Epoch |   Train Loss |   Train Acc |   Train Precision |   Train Recall |   Train F1 |   Val Loss |   Val Acc |   Val Precision |   Val Recall |   Val F1 |
|---------|--------------|-------------|-------------------|----------------|------------|------------|-----------|-----------------|--------------|----------|
|       3 |       0.6003 |      0.8302 |            0.7731 |         0.7466 |     0.7396 |     0.5498 |    0.8595 |           0.846 |       0.7987 |    0.812 |
2025-12-31 22:36:28,710 - INFO - 
[INFO]: Saving best model at epoch 3 to: checkpoints/TransformerEncoder_UIT_ViOCD/TransformerEncoder_UIT_ViOCD_best_model.pth
2025-12-31 22:36:32,530 - INFO - 
|   Epoch |   Train Loss |   Train Acc |   Train Precision |   Train Recall |   Train F1 |   Val Loss |   Val Acc |   Val Precision |   Val Recall |   Val F1 |
|---------|--------------|-------------|-------------------|----------------|------------|------------|-----------|-----------------|--------------|----------|
|       4 |        0.561 |      0.8467 |            0.7982 |         0.7778 |     0.7702 |     0.5401 |     0.865 |          0.8616 |       0.8012 |   0.8185 |
2025-12-31 22:36:32,530 - INFO - 
[INFO]: Saving best model at epoch 4 to: checkpoints/TransformerEncoder_UIT_ViOCD/TransformerEncoder_UIT_ViOCD_best_model.pth
2025-12-31 22:36:36,357 - INFO - 
|   Epoch |   Train Loss |   Train Acc |   Train Precision |   Train Recall |   Train F1 |   Val Loss |   Val Acc |   Val Precision |   Val Recall |   Val F1 |
|---------|--------------|-------------|-------------------|----------------|------------|------------|-----------|-----------------|--------------|----------|
|       5 |       0.5405 |      0.8514 |             0.813 |         0.7851 |      0.779 |     0.5291 |    0.8686 |          0.8515 |       0.8135 |   0.8248 |
2025-12-31 22:36:36,357 - INFO - 
[INFO]: Saving best model at epoch 5 to: checkpoints/TransformerEncoder_UIT_ViOCD/TransformerEncoder_UIT_ViOCD_best_model.pth
2025-12-31 22:36:40,260 - INFO - 
|   Epoch |   Train Loss |   Train Acc |   Train Precision |   Train Recall |   Train F1 |   Val Loss |   Val Acc |   Val Precision |   Val Recall |   Val F1 |
|---------|--------------|-------------|-------------------|----------------|------------|------------|-----------|-----------------|--------------|----------|
|       6 |       0.5093 |      0.8668 |            0.8214 |         0.7978 |     0.7925 |     0.5441 |    0.8485 |          0.8487 |       0.7917 |    0.807 |
2025-12-31 22:36:43,946 - INFO - 
|   Epoch |   Train Loss |   Train Acc |   Train Precision |   Train Recall |   Train F1 |   Val Loss |   Val Acc |   Val Precision |   Val Recall |   Val F1 |
|---------|--------------|-------------|-------------------|----------------|------------|------------|-----------|-----------------|--------------|----------|
|       7 |       0.4986 |      0.8786 |            0.8452 |         0.8186 |     0.8124 |      0.478 |    0.8777 |           0.872 |       0.8225 |   0.8377 |
2025-12-31 22:36:43,946 - INFO - 
[INFO]: Saving best model at epoch 7 to: checkpoints/TransformerEncoder_UIT_ViOCD/TransformerEncoder_UIT_ViOCD_best_model.pth
2025-12-31 22:36:47,791 - INFO - 
|   Epoch |   Train Loss |   Train Acc |   Train Precision |   Train Recall |   Train F1 |   Val Loss |   Val Acc |   Val Precision |   Val Recall |   Val F1 |
|---------|--------------|-------------|-------------------|----------------|------------|------------|-----------|-----------------|--------------|----------|
|       8 |       0.4967 |      0.8687 |            0.8384 |          0.813 |     0.8076 |     0.5115 |    0.8796 |          0.8818 |       0.8251 |   0.8401 |
2025-12-31 22:36:47,791 - INFO - 
[INFO]: Saving best model at epoch 8 to: checkpoints/TransformerEncoder_UIT_ViOCD/TransformerEncoder_UIT_ViOCD_best_model.pth
2025-12-31 22:36:51,519 - INFO - 
|   Epoch |   Train Loss |   Train Acc |   Train Precision |   Train Recall |   Train F1 |   Val Loss |   Val Acc |   Val Precision |   Val Recall |   Val F1 |
|---------|--------------|-------------|-------------------|----------------|------------|------------|-----------|-----------------|--------------|----------|
|       9 |       0.4807 |      0.8728 |            0.8372 |         0.8162 |     0.8113 |     0.4961 |    0.8796 |          0.8606 |       0.8252 |   0.8364 |
2025-12-31 22:36:55,224 - INFO - 
|   Epoch |   Train Loss |   Train Acc |   Train Precision |   Train Recall |   Train F1 |   Val Loss |   Val Acc |   Val Precision |   Val Recall |   Val F1 |
|---------|--------------|-------------|-------------------|----------------|------------|------------|-----------|-----------------|--------------|----------|
|      10 |       0.4745 |      0.8822 |             0.847 |         0.8298 |     0.8211 |     0.4996 |    0.8796 |          0.8629 |       0.8184 |   0.8317 |
2025-12-31 22:36:59,235 - INFO - 
|   Epoch |   Train Loss |   Train Acc |   Train Precision |   Train Recall |   Train F1 |   Val Loss |   Val Acc |   Val Precision |   Val Recall |   Val F1 |
|---------|--------------|-------------|-------------------|----------------|------------|------------|-----------|-----------------|--------------|----------|
|      11 |       0.4608 |      0.8868 |            0.8545 |         0.8417 |     0.8334 |     0.4874 |    0.8759 |          0.8625 |       0.8055 |   0.8218 |
2025-12-31 22:37:03,193 - INFO - 
|   Epoch |   Train Loss |   Train Acc |   Train Precision |   Train Recall |   Train F1 |   Val Loss |   Val Acc |   Val Precision |   Val Recall |   Val F1 |
|---------|--------------|-------------|-------------------|----------------|------------|------------|-----------|-----------------|--------------|----------|
|      12 |       0.4641 |      0.8819 |            0.8433 |         0.8211 |      0.817 |     0.4669 |    0.8978 |          0.8852 |        0.845 |   0.8588 |
2025-12-31 22:37:03,194 - INFO - 
[INFO]: Saving best model at epoch 12 to: checkpoints/TransformerEncoder_UIT_ViOCD/TransformerEncoder_UIT_ViOCD_best_model.pth
2025-12-31 22:37:07,063 - INFO - 
|   Epoch |   Train Loss |   Train Acc |   Train Precision |   Train Recall |   Train F1 |   Val Loss |   Val Acc |   Val Precision |   Val Recall |   Val F1 |
|---------|--------------|-------------|-------------------|----------------|------------|------------|-----------|-----------------|--------------|----------|
|      13 |       0.4607 |      0.8853 |            0.8469 |         0.8337 |     0.8271 |      0.466 |    0.8832 |           0.853 |       0.8273 |   0.8369 |
2025-12-31 22:37:10,585 - INFO - 
|   Epoch |   Train Loss |   Train Acc |   Train Precision |   Train Recall |   Train F1 |   Val Loss |   Val Acc |   Val Precision |   Val Recall |   Val F1 |
|---------|--------------|-------------|-------------------|----------------|------------|------------|-----------|-----------------|--------------|----------|
|      14 |       0.4504 |      0.8958 |            0.8594 |         0.8402 |      0.834 |     0.4722 |    0.8923 |          0.8656 |       0.8385 |   0.8489 |
2025-12-31 22:37:14,469 - INFO - 
|   Epoch |   Train Loss |   Train Acc |   Train Precision |   Train Recall |   Train F1 |   Val Loss |   Val Acc |   Val Precision |   Val Recall |   Val F1 |
|---------|--------------|-------------|-------------------|----------------|------------|------------|-----------|-----------------|--------------|----------|
|      15 |       0.4512 |      0.8882 |            0.8479 |         0.8366 |     0.8282 |     0.4482 |    0.8887 |          0.8711 |       0.8283 |   0.8422 |
2025-12-31 22:37:18,350 - INFO - 
|   Epoch |   Train Loss |   Train Acc |   Train Precision |   Train Recall |   Train F1 |   Val Loss |   Val Acc |   Val Precision |   Val Recall |   Val F1 |
|---------|--------------|-------------|-------------------|----------------|------------|------------|-----------|-----------------|--------------|----------|
|      16 |       0.4277 |      0.8999 |            0.8721 |         0.8506 |     0.8474 |     0.4688 |    0.8814 |           0.867 |       0.8261 |    0.839 |
2025-12-31 22:37:22,162 - INFO - 
|   Epoch |   Train Loss |   Train Acc |   Train Precision |   Train Recall |   Train F1 |   Val Loss |   Val Acc |   Val Precision |   Val Recall |   Val F1 |
|---------|--------------|-------------|-------------------|----------------|------------|------------|-----------|-----------------|--------------|----------|
|      17 |       0.4364 |      0.8965 |            0.8616 |         0.8426 |      0.838 |     0.4835 |     0.885 |           0.869 |       0.8288 |    0.842 |
2025-12-31 22:37:25,764 - INFO - 
|   Epoch |   Train Loss |   Train Acc |   Train Precision |   Train Recall |   Train F1 |   Val Loss |   Val Acc |   Val Precision |   Val Recall |   Val F1 |
|---------|--------------|-------------|-------------------|----------------|------------|------------|-----------|-----------------|--------------|----------|
|      18 |       0.4166 |      0.9065 |            0.8765 |         0.8575 |     0.8549 |     0.4583 |    0.8869 |          0.8605 |       0.8344 |   0.8445 |
2025-12-31 22:37:29,714 - INFO - 
|   Epoch |   Train Loss |   Train Acc |   Train Precision |   Train Recall |   Train F1 |   Val Loss |   Val Acc |   Val Precision |   Val Recall |   Val F1 |
|---------|--------------|-------------|-------------------|----------------|------------|------------|-----------|-----------------|--------------|----------|
|      19 |       0.4167 |      0.9058 |            0.8701 |         0.8536 |     0.8507 |     0.4547 |    0.8887 |          0.8648 |       0.8336 |    0.845 |
2025-12-31 22:37:33,668 - INFO - 
|   Epoch |   Train Loss |   Train Acc |   Train Precision |   Train Recall |   Train F1 |   Val Loss |   Val Acc |   Val Precision |   Val Recall |   Val F1 |
|---------|--------------|-------------|-------------------|----------------|------------|------------|-----------|-----------------|--------------|----------|
|      20 |       0.4066 |      0.9106 |            0.8887 |         0.8667 |     0.8634 |     0.4767 |    0.8814 |          0.8718 |       0.8126 |   0.8287 |
2025-12-31 22:37:37,258 - INFO - 
|   Epoch |   Train Loss |   Train Acc |   Train Precision |   Train Recall |   Train F1 |   Val Loss |   Val Acc |   Val Precision |   Val Recall |   Val F1 |
|---------|--------------|-------------|-------------------|----------------|------------|------------|-----------|-----------------|--------------|----------|
|      21 |       0.3954 |      0.9137 |            0.8851 |         0.8694 |     0.8639 |     0.4852 |     0.896 |          0.8918 |       0.8359 |   0.8538 |
2025-12-31 22:37:40,893 - INFO - 
|   Epoch |   Train Loss |   Train Acc |   Train Precision |   Train Recall |   Train F1 |   Val Loss |   Val Acc |   Val Precision |   Val Recall |   Val F1 |
|---------|--------------|-------------|-------------------|----------------|------------|------------|-----------|-----------------|--------------|----------|
|      22 |       0.4083 |      0.9072 |            0.8801 |         0.8587 |     0.8562 |     0.4907 |    0.8869 |          0.8522 |       0.8363 |   0.8423 |
2025-12-31 22:37:40,893 - INFO - TRIGGERED EARLY STOP AT 22! (Val F1 not improved for 10 epochs)
2025-12-31 22:37:40,894 - INFO - 
Best result based on F1 on validation set:
2025-12-31 22:37:40,894 - INFO - Best epoch: 12, Best Val_Loss: 0.4669, Val_F1: 0.8588
2025-12-31 22:37:40,895 - INFO - DONE TRAINING TransformerEncoder_UIT_ViOCD. Ran for 23 epochs.
2025-12-31 22:37:40,895 - INFO - 
[INFO] Starting final evaluation on the (unseen) test set...
2025-12-31 22:37:40,895 - INFO - Loading best model from checkpoints/TransformerEncoder_UIT_ViOCD/TransformerEncoder_UIT_ViOCD_best_model.pth for final test evaluation...
2025-12-31 22:37:40,942 - INFO - [INFO] Best model loaded successfully.
2025-12-31 22:37:41,075 - INFO - [INFO] Test evaluation completed successfully.
2025-12-31 22:37:41,077 - INFO - [INFO] Test Set Results: Loss: 0.4423, Acc: 0.8889, Precision: 0.8695, Recall: 0.8508, F1: 0.8585
2025-12-31 22:37:41,077 - INFO - 
Classification report for final (unseen) test set:
2025-12-31 22:37:41,077 - INFO - 
              precision    recall  f1-score   support

           0       0.96      0.94      0.95       194
           1       0.87      0.83      0.85       150
           2       0.84      0.93      0.88       159
           3       0.80      0.70      0.74        46

    accuracy                           0.89       549
   macro avg       0.87      0.85      0.86       549
weighted avg       0.89      0.89      0.89       549

2025-12-31 22:37:41,077 - INFO - Plotting training/validation results for TransformerEncoder_UIT_ViOCD.
2025-12-31 22:37:45,511 - INFO - 
Experiment TransformerEncoder_UIT_ViOCD finished successfully!
2025-12-31 22:38:05,136 - INFO - ==================================================
2025-12-31 22:38:05,136 - INFO - STARTING PROCESS FOR EXPERIMENT: TransformerEncoder_UIT_ViOCD
2025-12-31 22:38:05,136 - INFO - Log file location: ./results/text_classification\TransformerEncoder_UIT_ViOCD_training.log
2025-12-31 22:38:05,136 - INFO - Loading configuration from: E:\DS201.Q11\DS201\Lab_5\config\Transformer_Encoder_UIT_ViOCD.yml
2025-12-31 22:38:05,136 - INFO - 
Running Experiment: TransformerEncoder_UIT_ViOCD
2025-12-31 22:38:05,136 - INFO - Model: TransformerEncoder, Dataset: uit_viocd
2025-12-31 22:38:05,136 - INFO - Hyperparameters: {'epochs': 50, 'early_stop_patience': 10, 'lr': 0.0003, 'weight_decay': 1e-05, 'batch_size': 32, 'optimizer': 'Adam', 'step_size': 30, 'gamma': 0.1, 'optimizer_params': {}}
2025-12-31 22:38:05,159 - INFO - Using device: cuda
2025-12-31 22:38:05,312 - INFO - Loading dataset: uit_viocd
2025-12-31 22:38:05,332 - INFO - Train: 4387, Val: 548, Test: 549
2025-12-31 22:38:05,333 - INFO - Sample sentence size: torch.Size([20]), Number of classes: 4
2025-12-31 22:38:05,459 - INFO - 
[INFO] Class Distribution (Train Data):
+----------+---------+
| Label    |   Count |
+==========+=========+
| app      |    1613 |
+----------+---------+
| fashion  |    1368 |
+----------+---------+
| cosmetic |    1043 |
+----------+---------+
| mobile   |     363 |
+----------+---------+
2025-12-31 22:38:05,459 - INFO - Using optimizer: Adam with LR=0.0003, WeightDecay=1e-05
2025-12-31 22:38:06,658 - INFO - START TRAINING TransformerEncoder_UIT_ViOCD...
2025-12-31 22:38:06,658 - INFO - No checkpoint found at checkpoints/TransformerEncoder_UIT_ViOCD/TransformerEncoder_UIT_ViOCD_last_checkpoint.pth
2025-12-31 22:38:11,211 - INFO - 
|   Epoch |   Train Loss |   Train Acc |   Train Precision |   Train Recall |   Train F1 |   Val Loss |   Val Acc |   Val Precision |   Val Recall |   Val F1 |
|---------|--------------|-------------|-------------------|----------------|------------|------------|-----------|-----------------|--------------|----------|
|       0 |       0.9376 |      0.6583 |            0.5022 |         0.5308 |     0.5008 |     0.6834 |    0.7865 |          0.8132 |       0.6867 |   0.6933 |
2025-12-31 22:38:11,212 - INFO - 
[INFO]: Saving best model at epoch 0 to: checkpoints/TransformerEncoder_UIT_ViOCD/TransformerEncoder_UIT_ViOCD_best_model.pth
2025-12-31 22:38:15,502 - INFO - 
|   Epoch |   Train Loss |   Train Acc |   Train Precision |   Train Recall |   Train F1 |   Val Loss |   Val Acc |   Val Precision |   Val Recall |   Val F1 |
|---------|--------------|-------------|-------------------|----------------|------------|------------|-----------|-----------------|--------------|----------|
|       1 |        0.714 |      0.7726 |            0.6856 |         0.6799 |     0.6607 |     0.6891 |    0.7974 |          0.8296 |       0.7059 |   0.7104 |
2025-12-31 22:38:15,502 - INFO - 
[INFO]: Saving best model at epoch 1 to: checkpoints/TransformerEncoder_UIT_ViOCD/TransformerEncoder_UIT_ViOCD_best_model.pth
2025-12-31 22:38:19,689 - INFO - 
|   Epoch |   Train Loss |   Train Acc |   Train Precision |   Train Recall |   Train F1 |   Val Loss |   Val Acc |   Val Precision |   Val Recall |   Val F1 |
|---------|--------------|-------------|-------------------|----------------|------------|------------|-----------|-----------------|--------------|----------|
|       2 |       0.6379 |      0.8089 |            0.7439 |         0.7208 |     0.7111 |     0.6636 |    0.8212 |          0.8306 |       0.7707 |   0.7829 |
2025-12-31 22:38:19,690 - INFO - 
[INFO]: Saving best model at epoch 2 to: checkpoints/TransformerEncoder_UIT_ViOCD/TransformerEncoder_UIT_ViOCD_best_model.pth
2025-12-31 22:38:24,164 - INFO - 
|   Epoch |   Train Loss |   Train Acc |   Train Precision |   Train Recall |   Train F1 |   Val Loss |   Val Acc |   Val Precision |   Val Recall |   Val F1 |
|---------|--------------|-------------|-------------------|----------------|------------|------------|-----------|-----------------|--------------|----------|
|       3 |       0.6003 |      0.8302 |            0.7731 |         0.7466 |     0.7396 |     0.5498 |    0.8595 |           0.846 |       0.7987 |    0.812 |
2025-12-31 22:38:24,165 - INFO - 
[INFO]: Saving best model at epoch 3 to: checkpoints/TransformerEncoder_UIT_ViOCD/TransformerEncoder_UIT_ViOCD_best_model.pth
2025-12-31 22:38:29,083 - INFO - 
|   Epoch |   Train Loss |   Train Acc |   Train Precision |   Train Recall |   Train F1 |   Val Loss |   Val Acc |   Val Precision |   Val Recall |   Val F1 |
|---------|--------------|-------------|-------------------|----------------|------------|------------|-----------|-----------------|--------------|----------|
|       4 |        0.561 |      0.8467 |            0.7982 |         0.7778 |     0.7702 |     0.5401 |     0.865 |          0.8616 |       0.8012 |   0.8185 |
2025-12-31 22:38:29,084 - INFO - 
[INFO]: Saving best model at epoch 4 to: checkpoints/TransformerEncoder_UIT_ViOCD/TransformerEncoder_UIT_ViOCD_best_model.pth
2025-12-31 22:38:33,375 - INFO - 
|   Epoch |   Train Loss |   Train Acc |   Train Precision |   Train Recall |   Train F1 |   Val Loss |   Val Acc |   Val Precision |   Val Recall |   Val F1 |
|---------|--------------|-------------|-------------------|----------------|------------|------------|-----------|-----------------|--------------|----------|
|       5 |       0.5405 |      0.8514 |             0.813 |         0.7851 |      0.779 |     0.5291 |    0.8686 |          0.8515 |       0.8135 |   0.8248 |
2025-12-31 22:38:33,376 - INFO - 
[INFO]: Saving best model at epoch 5 to: checkpoints/TransformerEncoder_UIT_ViOCD/TransformerEncoder_UIT_ViOCD_best_model.pth
2025-12-31 22:38:37,012 - INFO - 
|   Epoch |   Train Loss |   Train Acc |   Train Precision |   Train Recall |   Train F1 |   Val Loss |   Val Acc |   Val Precision |   Val Recall |   Val F1 |
|---------|--------------|-------------|-------------------|----------------|------------|------------|-----------|-----------------|--------------|----------|
|       6 |       0.5093 |      0.8668 |            0.8214 |         0.7978 |     0.7925 |     0.5441 |    0.8485 |          0.8487 |       0.7917 |    0.807 |
2025-12-31 22:38:40,538 - INFO - 
|   Epoch |   Train Loss |   Train Acc |   Train Precision |   Train Recall |   Train F1 |   Val Loss |   Val Acc |   Val Precision |   Val Recall |   Val F1 |
|---------|--------------|-------------|-------------------|----------------|------------|------------|-----------|-----------------|--------------|----------|
|       7 |       0.4986 |      0.8786 |            0.8452 |         0.8186 |     0.8124 |      0.478 |    0.8777 |           0.872 |       0.8225 |   0.8377 |
2025-12-31 22:38:40,539 - INFO - 
[INFO]: Saving best model at epoch 7 to: checkpoints/TransformerEncoder_UIT_ViOCD/TransformerEncoder_UIT_ViOCD_best_model.pth
2025-12-31 22:38:44,353 - INFO - 
|   Epoch |   Train Loss |   Train Acc |   Train Precision |   Train Recall |   Train F1 |   Val Loss |   Val Acc |   Val Precision |   Val Recall |   Val F1 |
|---------|--------------|-------------|-------------------|----------------|------------|------------|-----------|-----------------|--------------|----------|
|       8 |       0.4967 |      0.8687 |            0.8384 |          0.813 |     0.8076 |     0.5115 |    0.8796 |          0.8818 |       0.8251 |   0.8401 |
2025-12-31 22:38:44,354 - INFO - 
[INFO]: Saving best model at epoch 8 to: checkpoints/TransformerEncoder_UIT_ViOCD/TransformerEncoder_UIT_ViOCD_best_model.pth
2025-12-31 22:38:48,148 - INFO - 
|   Epoch |   Train Loss |   Train Acc |   Train Precision |   Train Recall |   Train F1 |   Val Loss |   Val Acc |   Val Precision |   Val Recall |   Val F1 |
|---------|--------------|-------------|-------------------|----------------|------------|------------|-----------|-----------------|--------------|----------|
|       9 |       0.4807 |      0.8728 |            0.8372 |         0.8162 |     0.8113 |     0.4961 |    0.8796 |          0.8606 |       0.8252 |   0.8364 |
2025-12-31 22:38:52,162 - INFO - 
|   Epoch |   Train Loss |   Train Acc |   Train Precision |   Train Recall |   Train F1 |   Val Loss |   Val Acc |   Val Precision |   Val Recall |   Val F1 |
|---------|--------------|-------------|-------------------|----------------|------------|------------|-----------|-----------------|--------------|----------|
|      10 |       0.4745 |      0.8822 |             0.847 |         0.8298 |     0.8211 |     0.4996 |    0.8796 |          0.8629 |       0.8184 |   0.8317 |
2025-12-31 22:38:55,901 - INFO - 
|   Epoch |   Train Loss |   Train Acc |   Train Precision |   Train Recall |   Train F1 |   Val Loss |   Val Acc |   Val Precision |   Val Recall |   Val F1 |
|---------|--------------|-------------|-------------------|----------------|------------|------------|-----------|-----------------|--------------|----------|
|      11 |       0.4608 |      0.8868 |            0.8545 |         0.8417 |     0.8334 |     0.4874 |    0.8759 |          0.8625 |       0.8055 |   0.8218 |
2025-12-31 22:38:59,597 - INFO - 
|   Epoch |   Train Loss |   Train Acc |   Train Precision |   Train Recall |   Train F1 |   Val Loss |   Val Acc |   Val Precision |   Val Recall |   Val F1 |
|---------|--------------|-------------|-------------------|----------------|------------|------------|-----------|-----------------|--------------|----------|
|      12 |       0.4641 |      0.8819 |            0.8433 |         0.8211 |      0.817 |     0.4669 |    0.8978 |          0.8852 |        0.845 |   0.8588 |
2025-12-31 22:38:59,599 - INFO - 
[INFO]: Saving best model at epoch 12 to: checkpoints/TransformerEncoder_UIT_ViOCD/TransformerEncoder_UIT_ViOCD_best_model.pth
2025-12-31 22:39:03,342 - INFO - 
|   Epoch |   Train Loss |   Train Acc |   Train Precision |   Train Recall |   Train F1 |   Val Loss |   Val Acc |   Val Precision |   Val Recall |   Val F1 |
|---------|--------------|-------------|-------------------|----------------|------------|------------|-----------|-----------------|--------------|----------|
|      13 |       0.4607 |      0.8853 |            0.8469 |         0.8337 |     0.8271 |      0.466 |    0.8832 |           0.853 |       0.8273 |   0.8369 |
2025-12-31 22:39:07,111 - INFO - 
|   Epoch |   Train Loss |   Train Acc |   Train Precision |   Train Recall |   Train F1 |   Val Loss |   Val Acc |   Val Precision |   Val Recall |   Val F1 |
|---------|--------------|-------------|-------------------|----------------|------------|------------|-----------|-----------------|--------------|----------|
|      14 |       0.4504 |      0.8958 |            0.8594 |         0.8402 |      0.834 |     0.4722 |    0.8923 |          0.8656 |       0.8385 |   0.8489 |
2025-12-31 22:39:10,973 - INFO - 
|   Epoch |   Train Loss |   Train Acc |   Train Precision |   Train Recall |   Train F1 |   Val Loss |   Val Acc |   Val Precision |   Val Recall |   Val F1 |
|---------|--------------|-------------|-------------------|----------------|------------|------------|-----------|-----------------|--------------|----------|
|      15 |       0.4512 |      0.8882 |            0.8479 |         0.8366 |     0.8282 |     0.4482 |    0.8887 |          0.8711 |       0.8283 |   0.8422 |
2025-12-31 22:39:14,771 - INFO - 
|   Epoch |   Train Loss |   Train Acc |   Train Precision |   Train Recall |   Train F1 |   Val Loss |   Val Acc |   Val Precision |   Val Recall |   Val F1 |
|---------|--------------|-------------|-------------------|----------------|------------|------------|-----------|-----------------|--------------|----------|
|      16 |       0.4277 |      0.8999 |            0.8721 |         0.8506 |     0.8474 |     0.4688 |    0.8814 |           0.867 |       0.8261 |    0.839 |
2025-12-31 22:39:18,517 - INFO - 
|   Epoch |   Train Loss |   Train Acc |   Train Precision |   Train Recall |   Train F1 |   Val Loss |   Val Acc |   Val Precision |   Val Recall |   Val F1 |
|---------|--------------|-------------|-------------------|----------------|------------|------------|-----------|-----------------|--------------|----------|
|      17 |       0.4364 |      0.8965 |            0.8616 |         0.8426 |      0.838 |     0.4835 |     0.885 |           0.869 |       0.8288 |    0.842 |
2025-12-31 22:39:22,232 - INFO - 
|   Epoch |   Train Loss |   Train Acc |   Train Precision |   Train Recall |   Train F1 |   Val Loss |   Val Acc |   Val Precision |   Val Recall |   Val F1 |
|---------|--------------|-------------|-------------------|----------------|------------|------------|-----------|-----------------|--------------|----------|
|      18 |       0.4166 |      0.9065 |            0.8765 |         0.8575 |     0.8549 |     0.4583 |    0.8869 |          0.8605 |       0.8344 |   0.8445 |
2025-12-31 22:39:26,000 - INFO - 
|   Epoch |   Train Loss |   Train Acc |   Train Precision |   Train Recall |   Train F1 |   Val Loss |   Val Acc |   Val Precision |   Val Recall |   Val F1 |
|---------|--------------|-------------|-------------------|----------------|------------|------------|-----------|-----------------|--------------|----------|
|      19 |       0.4167 |      0.9058 |            0.8701 |         0.8536 |     0.8507 |     0.4547 |    0.8887 |          0.8648 |       0.8336 |    0.845 |
2025-12-31 22:39:29,711 - INFO - 
|   Epoch |   Train Loss |   Train Acc |   Train Precision |   Train Recall |   Train F1 |   Val Loss |   Val Acc |   Val Precision |   Val Recall |   Val F1 |
|---------|--------------|-------------|-------------------|----------------|------------|------------|-----------|-----------------|--------------|----------|
|      20 |       0.4066 |      0.9106 |            0.8887 |         0.8667 |     0.8634 |     0.4767 |    0.8814 |          0.8718 |       0.8126 |   0.8287 |
2025-12-31 22:39:33,381 - INFO - 
|   Epoch |   Train Loss |   Train Acc |   Train Precision |   Train Recall |   Train F1 |   Val Loss |   Val Acc |   Val Precision |   Val Recall |   Val F1 |
|---------|--------------|-------------|-------------------|----------------|------------|------------|-----------|-----------------|--------------|----------|
|      21 |       0.3954 |      0.9137 |            0.8851 |         0.8694 |     0.8639 |     0.4852 |     0.896 |          0.8918 |       0.8359 |   0.8538 |
2025-12-31 22:39:37,114 - INFO - 
|   Epoch |   Train Loss |   Train Acc |   Train Precision |   Train Recall |   Train F1 |   Val Loss |   Val Acc |   Val Precision |   Val Recall |   Val F1 |
|---------|--------------|-------------|-------------------|----------------|------------|------------|-----------|-----------------|--------------|----------|
|      22 |       0.4083 |      0.9072 |            0.8801 |         0.8587 |     0.8562 |     0.4907 |    0.8869 |          0.8522 |       0.8363 |   0.8423 |
2025-12-31 22:39:37,114 - INFO - TRIGGERED EARLY STOP AT 22! (Val F1 not improved for 10 epochs)
2025-12-31 22:39:37,114 - INFO - 
Best result based on F1 on validation set:
2025-12-31 22:39:37,114 - INFO - Best epoch: 12, Best Val_Loss: 0.4669, Val_F1: 0.8588
2025-12-31 22:39:37,114 - INFO - DONE TRAINING TransformerEncoder_UIT_ViOCD. Ran for 23 epochs.
2025-12-31 22:39:37,114 - INFO - 
[INFO] Starting final evaluation on the (unseen) test set...
2025-12-31 22:39:37,115 - INFO - Loading best model from checkpoints/TransformerEncoder_UIT_ViOCD/TransformerEncoder_UIT_ViOCD_best_model.pth for final test evaluation...
2025-12-31 22:39:37,161 - INFO - [INFO] Best model loaded successfully.
2025-12-31 22:39:37,324 - INFO - [INFO] Test evaluation completed successfully.
2025-12-31 22:39:37,325 - INFO - [INFO] Test Set Results: Loss: 0.4423, Acc: 0.8889, Precision: 0.8695, Recall: 0.8508, F1: 0.8585
2025-12-31 22:39:37,325 - INFO - 
Classification report for final (unseen) test set:
2025-12-31 22:39:37,325 - INFO - 
              precision    recall  f1-score   support

           0       0.96      0.94      0.95       194
           1       0.87      0.83      0.85       150
           2       0.84      0.93      0.88       159
           3       0.80      0.70      0.74        46

    accuracy                           0.89       549
   macro avg       0.87      0.85      0.86       549
weighted avg       0.89      0.89      0.89       549

2025-12-31 22:39:37,326 - INFO - Plotting training/validation results for TransformerEncoder_UIT_ViOCD.
2025-12-31 22:39:41,657 - INFO - 
Experiment TransformerEncoder_UIT_ViOCD finished successfully!
2025-12-31 22:40:07,574 - INFO - ==================================================
2025-12-31 22:40:07,574 - INFO - STARTING PROCESS FOR EXPERIMENT: TransformerEncoder_UIT_ViOCD
2025-12-31 22:40:07,574 - INFO - Log file location: ./results/text_classification\TransformerEncoder_UIT_ViOCD_training.log
2025-12-31 22:40:07,574 - INFO - Loading configuration from: E:\DS201.Q11\DS201\Lab_5\config\Transformer_Encoder_UIT_ViOCD.yml
2025-12-31 22:40:07,574 - INFO - 
Running Experiment: TransformerEncoder_UIT_ViOCD
2025-12-31 22:40:07,574 - INFO - Model: TransformerEncoder, Dataset: uit_viocd
2025-12-31 22:40:07,574 - INFO - Hyperparameters: {'epochs': 50, 'early_stop_patience': 10, 'lr': 0.0002, 'weight_decay': 1e-05, 'batch_size': 32, 'optimizer': 'Adam', 'step_size': 30, 'gamma': 0.1, 'optimizer_params': {}}
2025-12-31 22:40:07,597 - INFO - Using device: cuda
2025-12-31 22:40:07,720 - INFO - Loading dataset: uit_viocd
2025-12-31 22:40:07,737 - INFO - Train: 4387, Val: 548, Test: 549
2025-12-31 22:40:07,738 - INFO - Sample sentence size: torch.Size([20]), Number of classes: 4
2025-12-31 22:40:07,838 - INFO - 
[INFO] Class Distribution (Train Data):
+----------+---------+
| Label    |   Count |
+==========+=========+
| app      |    1613 |
+----------+---------+
| fashion  |    1368 |
+----------+---------+
| cosmetic |    1043 |
+----------+---------+
| mobile   |     363 |
+----------+---------+
2025-12-31 22:40:07,838 - INFO - Using optimizer: Adam with LR=0.0002, WeightDecay=1e-05
2025-12-31 22:40:09,123 - INFO - START TRAINING TransformerEncoder_UIT_ViOCD...
2025-12-31 22:40:09,123 - INFO - No checkpoint found at checkpoints/TransformerEncoder_UIT_ViOCD/TransformerEncoder_UIT_ViOCD_last_checkpoint.pth
2025-12-31 22:40:13,062 - INFO - 
|   Epoch |   Train Loss |   Train Acc |   Train Precision |   Train Recall |   Train F1 |   Val Loss |   Val Acc |   Val Precision |   Val Recall |   Val F1 |
|---------|--------------|-------------|-------------------|----------------|------------|------------|-----------|-----------------|--------------|----------|
|       0 |       0.7927 |       0.683 |            0.5452 |         0.5645 |     0.5361 |     0.4919 |    0.8139 |          0.8256 |       0.7299 |   0.7488 |
2025-12-31 22:40:13,062 - INFO - 
[INFO]: Saving best model at epoch 0 to: checkpoints/TransformerEncoder_UIT_ViOCD/TransformerEncoder_UIT_ViOCD_best_model.pth
2025-12-31 22:40:16,775 - INFO - 
|   Epoch |   Train Loss |   Train Acc |   Train Precision |   Train Recall |   Train F1 |   Val Loss |   Val Acc |   Val Precision |   Val Recall |   Val F1 |
|---------|--------------|-------------|-------------------|----------------|------------|------------|-----------|-----------------|--------------|----------|
|       1 |       0.5071 |       0.812 |            0.7435 |         0.7264 |     0.7152 |     0.4014 |    0.8339 |           0.827 |       0.7517 |   0.7671 |
2025-12-31 22:40:16,776 - INFO - 
[INFO]: Saving best model at epoch 1 to: checkpoints/TransformerEncoder_UIT_ViOCD/TransformerEncoder_UIT_ViOCD_best_model.pth
2025-12-31 22:40:20,691 - INFO - 
|   Epoch |   Train Loss |   Train Acc |   Train Precision |   Train Recall |   Train F1 |   Val Loss |   Val Acc |   Val Precision |   Val Recall |   Val F1 |
|---------|--------------|-------------|-------------------|----------------|------------|------------|-----------|-----------------|--------------|----------|
|       2 |       0.4168 |      0.8508 |            0.8064 |         0.7788 |      0.776 |     0.4514 |    0.8449 |          0.8274 |       0.7922 |   0.7996 |
2025-12-31 22:40:20,692 - INFO - 
[INFO]: Saving best model at epoch 2 to: checkpoints/TransformerEncoder_UIT_ViOCD/TransformerEncoder_UIT_ViOCD_best_model.pth
2025-12-31 22:40:24,479 - INFO - 
|   Epoch |   Train Loss |   Train Acc |   Train Precision |   Train Recall |   Train F1 |   Val Loss |   Val Acc |   Val Precision |   Val Recall |   Val F1 |
|---------|--------------|-------------|-------------------|----------------|------------|------------|-----------|-----------------|--------------|----------|
|       3 |       0.3527 |      0.8696 |            0.8347 |         0.8147 |      0.809 |     0.3369 |    0.8777 |          0.8505 |       0.8288 |   0.8368 |
2025-12-31 22:40:24,480 - INFO - 
[INFO]: Saving best model at epoch 3 to: checkpoints/TransformerEncoder_UIT_ViOCD/TransformerEncoder_UIT_ViOCD_best_model.pth
2025-12-31 22:40:28,361 - INFO - 
|   Epoch |   Train Loss |   Train Acc |   Train Precision |   Train Recall |   Train F1 |   Val Loss |   Val Acc |   Val Precision |   Val Recall |   Val F1 |
|---------|--------------|-------------|-------------------|----------------|------------|------------|-----------|-----------------|--------------|----------|
|       4 |       0.3047 |      0.8897 |            0.8492 |          0.835 |      0.828 |     0.3523 |    0.8668 |          0.8467 |       0.8153 |   0.8259 |
2025-12-31 22:40:32,319 - INFO - 
|   Epoch |   Train Loss |   Train Acc |   Train Precision |   Train Recall |   Train F1 |   Val Loss |   Val Acc |   Val Precision |   Val Recall |   Val F1 |
|---------|--------------|-------------|-------------------|----------------|------------|------------|-----------|-----------------|--------------|----------|
|       5 |       0.2879 |      0.8952 |            0.8634 |         0.8497 |     0.8438 |     0.3359 |    0.8796 |          0.8383 |       0.8335 |   0.8351 |
2025-12-31 22:40:36,044 - INFO - 
|   Epoch |   Train Loss |   Train Acc |   Train Precision |   Train Recall |   Train F1 |   Val Loss |   Val Acc |   Val Precision |   Val Recall |   Val F1 |
|---------|--------------|-------------|-------------------|----------------|------------|------------|-----------|-----------------|--------------|----------|
|       6 |       0.2595 |      0.9058 |             0.879 |         0.8589 |     0.8545 |     0.3513 |     0.885 |          0.8718 |       0.8199 |   0.8359 |
2025-12-31 22:40:39,705 - INFO - 
|   Epoch |   Train Loss |   Train Acc |   Train Precision |   Train Recall |   Train F1 |   Val Loss |   Val Acc |   Val Precision |   Val Recall |   Val F1 |
|---------|--------------|-------------|-------------------|----------------|------------|------------|-----------|-----------------|--------------|----------|
|       7 |       0.2548 |       0.909 |            0.8811 |         0.8662 |     0.8599 |     0.3325 |    0.8704 |          0.8407 |       0.8062 |   0.8171 |
2025-12-31 22:40:43,433 - INFO - 
|   Epoch |   Train Loss |   Train Acc |   Train Precision |   Train Recall |   Train F1 |   Val Loss |   Val Acc |   Val Precision |   Val Recall |   Val F1 |
|---------|--------------|-------------|-------------------|----------------|------------|------------|-----------|-----------------|--------------|----------|
|       8 |       0.2296 |      0.9169 |            0.8861 |         0.8792 |     0.8706 |     0.3476 |    0.8796 |          0.8571 |       0.8141 |   0.8274 |
2025-12-31 22:40:47,010 - INFO - 
|   Epoch |   Train Loss |   Train Acc |   Train Precision |   Train Recall |   Train F1 |   Val Loss |   Val Acc |   Val Precision |   Val Recall |   Val F1 |
|---------|--------------|-------------|-------------------|----------------|------------|------------|-----------|-----------------|--------------|----------|
|       9 |       0.2255 |      0.9158 |            0.8881 |          0.872 |     0.8682 |     0.3446 |    0.8832 |          0.8596 |       0.8274 |   0.8385 |
2025-12-31 22:40:47,011 - INFO - 
[INFO]: Saving best model at epoch 9 to: checkpoints/TransformerEncoder_UIT_ViOCD/TransformerEncoder_UIT_ViOCD_best_model.pth
2025-12-31 22:40:50,676 - INFO - 
|   Epoch |   Train Loss |   Train Acc |   Train Precision |   Train Recall |   Train F1 |   Val Loss |   Val Acc |   Val Precision |   Val Recall |   Val F1 |
|---------|--------------|-------------|-------------------|----------------|------------|------------|-----------|-----------------|--------------|----------|
|      10 |       0.2192 |      0.9173 |            0.8839 |         0.8763 |     0.8683 |     0.3585 |    0.8923 |          0.8781 |       0.8273 |   0.8431 |
2025-12-31 22:40:50,676 - INFO - 
[INFO]: Saving best model at epoch 10 to: checkpoints/TransformerEncoder_UIT_ViOCD/TransformerEncoder_UIT_ViOCD_best_model.pth
2025-12-31 22:40:54,344 - INFO - 
|   Epoch |   Train Loss |   Train Acc |   Train Precision |   Train Recall |   Train F1 |   Val Loss |   Val Acc |   Val Precision |   Val Recall |   Val F1 |
|---------|--------------|-------------|-------------------|----------------|------------|------------|-----------|-----------------|--------------|----------|
|      11 |       0.1916 |      0.9275 |             0.905 |         0.8966 |     0.8894 |     0.3541 |     0.885 |          0.8715 |       0.8166 |   0.8329 |
2025-12-31 22:40:58,139 - INFO - 
|   Epoch |   Train Loss |   Train Acc |   Train Precision |   Train Recall |   Train F1 |   Val Loss |   Val Acc |   Val Precision |   Val Recall |   Val F1 |
|---------|--------------|-------------|-------------------|----------------|------------|------------|-----------|-----------------|--------------|----------|
|      12 |       0.1893 |      0.9306 |             0.907 |         0.8913 |     0.8898 |     0.3677 |    0.8814 |          0.8287 |        0.825 |   0.8259 |
2025-12-31 22:41:02,003 - INFO - 
|   Epoch |   Train Loss |   Train Acc |   Train Precision |   Train Recall |   Train F1 |   Val Loss |   Val Acc |   Val Precision |   Val Recall |   Val F1 |
|---------|--------------|-------------|-------------------|----------------|------------|------------|-----------|-----------------|--------------|----------|
|      13 |       0.1785 |      0.9296 |            0.9115 |          0.897 |     0.8946 |     0.3573 |    0.8814 |          0.8472 |       0.8199 |   0.8297 |
2025-12-31 22:41:05,949 - INFO - 
|   Epoch |   Train Loss |   Train Acc |   Train Precision |   Train Recall |   Train F1 |   Val Loss |   Val Acc |   Val Precision |   Val Recall |   Val F1 |
|---------|--------------|-------------|-------------------|----------------|------------|------------|-----------|-----------------|--------------|----------|
|      14 |       0.1799 |      0.9301 |            0.8985 |         0.8903 |     0.8838 |     0.3877 |    0.8723 |          0.8347 |       0.8168 |   0.8232 |
2025-12-31 22:41:09,874 - INFO - 
|   Epoch |   Train Loss |   Train Acc |   Train Precision |   Train Recall |   Train F1 |   Val Loss |   Val Acc |   Val Precision |   Val Recall |   Val F1 |
|---------|--------------|-------------|-------------------|----------------|------------|------------|-----------|-----------------|--------------|----------|
|      15 |       0.1774 |      0.9359 |            0.9205 |         0.9128 |     0.9079 |     0.3827 |    0.8923 |          0.8521 |        0.837 |   0.8429 |
2025-12-31 22:41:13,772 - INFO - 
|   Epoch |   Train Loss |   Train Acc |   Train Precision |   Train Recall |   Train F1 |   Val Loss |   Val Acc |   Val Precision |   Val Recall |   Val F1 |
|---------|--------------|-------------|-------------------|----------------|------------|------------|-----------|-----------------|--------------|----------|
|      16 |       0.1516 |      0.9432 |            0.9142 |         0.9067 |     0.9022 |      0.388 |     0.885 |          0.8455 |       0.8402 |   0.8424 |
2025-12-31 22:41:17,708 - INFO - 
|   Epoch |   Train Loss |   Train Acc |   Train Precision |   Train Recall |   Train F1 |   Val Loss |   Val Acc |   Val Precision |   Val Recall |   Val F1 |
|---------|--------------|-------------|-------------------|----------------|------------|------------|-----------|-----------------|--------------|----------|
|      17 |       0.1487 |      0.9441 |            0.9228 |         0.9138 |     0.9104 |     0.4061 |    0.8887 |          0.8744 |       0.8215 |   0.8372 |
2025-12-31 22:41:22,193 - INFO - 
|   Epoch |   Train Loss |   Train Acc |   Train Precision |   Train Recall |   Train F1 |   Val Loss |   Val Acc |   Val Precision |   Val Recall |   Val F1 |
|---------|--------------|-------------|-------------------|----------------|------------|------------|-----------|-----------------|--------------|----------|
|      18 |       0.1427 |       0.942 |            0.9236 |         0.9127 |     0.9108 |     0.3702 |    0.8923 |          0.8671 |       0.8412 |   0.8514 |
2025-12-31 22:41:22,194 - INFO - 
[INFO]: Saving best model at epoch 18 to: checkpoints/TransformerEncoder_UIT_ViOCD/TransformerEncoder_UIT_ViOCD_best_model.pth
2025-12-31 22:41:26,308 - INFO - 
|   Epoch |   Train Loss |   Train Acc |   Train Precision |   Train Recall |   Train F1 |   Val Loss |   Val Acc |   Val Precision |   Val Recall |   Val F1 |
|---------|--------------|-------------|-------------------|----------------|------------|------------|-----------|-----------------|--------------|----------|
|      19 |       0.1457 |       0.947 |            0.9285 |         0.9226 |     0.9181 |     0.3585 |    0.8942 |           0.858 |       0.8587 |   0.8577 |
2025-12-31 22:41:26,310 - INFO - 
[INFO]: Saving best model at epoch 19 to: checkpoints/TransformerEncoder_UIT_ViOCD/TransformerEncoder_UIT_ViOCD_best_model.pth
2025-12-31 22:41:30,203 - INFO - 
|   Epoch |   Train Loss |   Train Acc |   Train Precision |   Train Recall |   Train F1 |   Val Loss |   Val Acc |   Val Precision |   Val Recall |   Val F1 |
|---------|--------------|-------------|-------------------|----------------|------------|------------|-----------|-----------------|--------------|----------|
|      20 |       0.1374 |      0.9497 |            0.9345 |         0.9232 |     0.9212 |     0.3975 |    0.8923 |          0.8708 |       0.8212 |   0.8357 |
2025-12-31 22:41:34,173 - INFO - 
|   Epoch |   Train Loss |   Train Acc |   Train Precision |   Train Recall |   Train F1 |   Val Loss |   Val Acc |   Val Precision |   Val Recall |   Val F1 |
|---------|--------------|-------------|-------------------|----------------|------------|------------|-----------|-----------------|--------------|----------|
|      21 |       0.1276 |       0.954 |            0.9387 |         0.9275 |     0.9262 |     0.3918 |     0.896 |           0.867 |       0.8474 |   0.8557 |
2025-12-31 22:41:38,387 - INFO - 
|   Epoch |   Train Loss |   Train Acc |   Train Precision |   Train Recall |   Train F1 |   Val Loss |   Val Acc |   Val Precision |   Val Recall |   Val F1 |
|---------|--------------|-------------|-------------------|----------------|------------|------------|-----------|-----------------|--------------|----------|
|      22 |       0.1443 |       0.946 |            0.9253 |         0.9207 |     0.9156 |     0.4087 |    0.8923 |          0.8753 |       0.8344 |   0.8481 |
2025-12-31 22:41:42,526 - INFO - 
|   Epoch |   Train Loss |   Train Acc |   Train Precision |   Train Recall |   Train F1 |   Val Loss |   Val Acc |   Val Precision |   Val Recall |   Val F1 |
|---------|--------------|-------------|-------------------|----------------|------------|------------|-----------|-----------------|--------------|----------|
|      23 |        0.143 |      0.9493 |            0.9354 |         0.9286 |     0.9251 |      0.388 |    0.8887 |          0.8513 |       0.8376 |   0.8436 |
2025-12-31 22:41:46,572 - INFO - 
|   Epoch |   Train Loss |   Train Acc |   Train Precision |   Train Recall |   Train F1 |   Val Loss |   Val Acc |   Val Precision |   Val Recall |   Val F1 |
|---------|--------------|-------------|-------------------|----------------|------------|------------|-----------|-----------------|--------------|----------|
|      24 |       0.1118 |      0.9583 |            0.9403 |         0.9392 |     0.9338 |      0.429 |    0.8923 |          0.8801 |       0.8361 |   0.8514 |
2025-12-31 22:41:50,518 - INFO - 
|   Epoch |   Train Loss |   Train Acc |   Train Precision |   Train Recall |   Train F1 |   Val Loss |   Val Acc |   Val Precision |   Val Recall |   Val F1 |
|---------|--------------|-------------|-------------------|----------------|------------|------------|-----------|-----------------|--------------|----------|
|      25 |       0.1235 |      0.9552 |            0.9318 |         0.9312 |     0.9238 |     0.3425 |    0.8978 |          0.8733 |       0.8444 |   0.8553 |
2025-12-31 22:41:54,476 - INFO - 
|   Epoch |   Train Loss |   Train Acc |   Train Precision |   Train Recall |   Train F1 |   Val Loss |   Val Acc |   Val Precision |   Val Recall |   Val F1 |
|---------|--------------|-------------|-------------------|----------------|------------|------------|-----------|-----------------|--------------|----------|
|      26 |        0.121 |      0.9556 |            0.9411 |         0.9373 |     0.9325 |     0.3857 |    0.8923 |           0.867 |       0.8446 |   0.8529 |
2025-12-31 22:41:58,288 - INFO - 
|   Epoch |   Train Loss |   Train Acc |   Train Precision |   Train Recall |   Train F1 |   Val Loss |   Val Acc |   Val Precision |   Val Recall |   Val F1 |
|---------|--------------|-------------|-------------------|----------------|------------|------------|-----------|-----------------|--------------|----------|
|      27 |        0.115 |      0.9592 |            0.9409 |         0.9359 |      0.932 |     0.3893 |    0.8887 |           0.857 |       0.8393 |   0.8458 |
2025-12-31 22:42:02,173 - INFO - 
|   Epoch |   Train Loss |   Train Acc |   Train Precision |   Train Recall |   Train F1 |   Val Loss |   Val Acc |   Val Precision |   Val Recall |   Val F1 |
|---------|--------------|-------------|-------------------|----------------|------------|------------|-----------|-----------------|--------------|----------|
|      28 |        0.101 |      0.9622 |            0.9499 |         0.9412 |     0.9388 |     0.3855 |     0.896 |          0.8798 |       0.8416 |   0.8554 |
2025-12-31 22:42:05,884 - INFO - 
|   Epoch |   Train Loss |   Train Acc |   Train Precision |   Train Recall |   Train F1 |   Val Loss |   Val Acc |   Val Precision |   Val Recall |   Val F1 |
|---------|--------------|-------------|-------------------|----------------|------------|------------|-----------|-----------------|--------------|----------|
|      29 |       0.1086 |      0.9588 |             0.948 |         0.9386 |     0.9359 |     0.3869 |    0.8978 |          0.8753 |       0.8373 |   0.8491 |
2025-12-31 22:42:05,885 - INFO - TRIGGERED EARLY STOP AT 29! (Val F1 not improved for 10 epochs)
2025-12-31 22:42:05,886 - INFO - 
Best result based on F1 on validation set:
2025-12-31 22:42:05,886 - INFO - Best epoch: 19, Best Val_Loss: 0.3585, Val_F1: 0.8577
2025-12-31 22:42:05,886 - INFO - DONE TRAINING TransformerEncoder_UIT_ViOCD. Ran for 30 epochs.
2025-12-31 22:42:05,886 - INFO - 
[INFO] Starting final evaluation on the (unseen) test set...
2025-12-31 22:42:05,886 - INFO - Loading best model from checkpoints/TransformerEncoder_UIT_ViOCD/TransformerEncoder_UIT_ViOCD_best_model.pth for final test evaluation...
2025-12-31 22:42:05,935 - INFO - [INFO] Best model loaded successfully.
2025-12-31 22:42:06,080 - INFO - [INFO] Test evaluation completed successfully.
2025-12-31 22:42:06,080 - INFO - [INFO] Test Set Results: Loss: 0.2665, Acc: 0.9089, Precision: 0.8683, Recall: 0.8869, F1: 0.8763
2025-12-31 22:42:06,080 - INFO - 
Classification report for final (unseen) test set:
2025-12-31 22:42:06,080 - INFO - 
              precision    recall  f1-score   support

           0       0.98      0.96      0.97       194
           1       0.90      0.88      0.89       150
           2       0.91      0.90      0.91       159
           3       0.69      0.80      0.74        46

    accuracy                           0.91       549
   macro avg       0.87      0.89      0.88       549
weighted avg       0.91      0.91      0.91       549

2025-12-31 22:42:06,080 - INFO - Plotting training/validation results for TransformerEncoder_UIT_ViOCD.
2025-12-31 22:42:09,094 - INFO - 
Experiment TransformerEncoder_UIT_ViOCD finished successfully!
